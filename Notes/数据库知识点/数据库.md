##### 如何设计一个关系型数据库

首先要划分为两部分，一个时存储部分，文件系统。

数据库结构：要有一个存储模块，存储文件系统，如机械硬盘，SSD固态硬盘，程序实例来映射

##### 索引

为什么要使用索引

>在面对少量数据的时候，如几十条数据，应用全局查找，全表扫描会快。如果在面对大量数据的时候，存储的最小单位是块或者页。
>
>- 为了避免全表扫描，便利用了索引，快速查询数据。 
>
>

什么样的信息能成为索引

> 主键，唯一键，普通键也可以。

索引的数据结构

> 二叉查找树，B树，B+树（通常是B+），Hash结构
>
> mysql 利用的B+树，B+树磁盘读写代价更低；查询效率更加稳定；B+更有利于对数据库的扫描，只需要遍历叶子节点就是所有数据，对范围查询有更好；
>
> B 树，平衡多路查找树。根节点至少包含两个孩子，跟中每个节点最多包含m个孩子，除去根节点和叶子节点，所有叶子节点都在同一层。B数里面关键数比指针少一个
>
> B+树，非叶子节点的关键数与指针相同；非叶子节点是索引，所有数据都保存在叶子节点里面。所有叶子节点都有一个链指针指向下一个叶子节点，支持范围统计。
>
> Hash索引： 不能满足 = IN， 不能算范围，只能算具体值；无法避免数据排序，不能利用部分索引键查询；不能避免表扫描
>
> BitMap

密集索引：每个文件每个搜索码值都对应一个索引值

稀疏索引：只有某些索引码的某些值建立索引项

innoDB 数据和索引存在一块，而MyISAM数据和索引是分开的

![1547534474563](C:\Users\xuanyupan\AppData\Roaming\Typora\typora-user-images\1547534474563.png)

如何定位并优化慢查询Sql，

1.根据慢日志定位慢查询sql；

2.使用explain查看慢sql，分析sql语句。直接在查询语句前 explain，可以查看sql语句查询的一些数据，先看type查看查询方式，index和all是全表查询；查看extra项，using filesort文件排序，using temporary临时排序，出现这两种需要优化语句

3.修改sql语句，利用索引

索引不是建立越多越好，数据量小的表不要建立索引，经常要变更的数据不需要。



##### ![1547546562401](C:\Users\xuanyupan\AppData\Roaming\Typora\typora-user-images\1547546562401.png)



